<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>批量导入采购清单</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <header class="navbar">
    <div class="logo"><a href="index.html">[Logo] 医药采购平台</a></div>
    <nav class="nav-links">
      <a href="upload.html">Excel导入</a>
      <a href="result.html">批量结果</a>
      <a href="detail.html">单品结果</a>
    </nav>
  </header>

  <main>
    <h2>批量导入采购清单</h2>

    <div class="card" style="text-align: center;">
      <div style="border: 2px dashed #ccc; padding: 30px; border-radius: 8px; cursor: pointer;" id="dropArea">
        <p><strong>拖拽Excel文件到此处</strong> 或点击选择</p>
        <p style="color: #888;">支持格式：.xls, .xlsx</p>
        <input type="file" id="fileInput" accept=".xls,.xlsx" style="display:none;" />
      </div>

      <button class="btn" id="uploadBtn">上传并解析</button>
      <p style="margin-top: 10px;"><a href="template.html">下载采购清单模板</a> ｜ <a href="instructions.html">查看导入说明</a></p>
    </div>

    <div class="return-home">
      <a href="index.html" class="btn-secondary">返回首页</a>
    </div>
  </main>

  <script src="js/common.js"></script>
  <script>
    const dropArea = document.getElementById('dropArea');
    const fileInput = document.getElementById('fileInput');
    const uploadBtn = document.getElementById('uploadBtn');

    dropArea.addEventListener('click', () => fileInput.click());
    dropArea.addEventListener('dragover', e => {
      e.preventDefault();
      dropArea.style.background = '#f0f8ff';
    });
    dropArea.addEventListener('dragleave', e => {
      e.preventDefault();
      dropArea.style.background = '';
    });
    dropArea.addEventListener('drop', e => {
      e.preventDefault();
      dropArea.style.background = '';
      fileInput.files = e.dataTransfer.files;
    });

    uploadBtn.addEventListener('click', () => {
      if (!fileInput.files.length) {
        alert("请先选择文件");
        return;
      }
      uploadBtn.textContent = "正在解析...";
      setTimeout(() => window.location.href = "result.html", 2000);
    });
  </script>
</body>
</html>